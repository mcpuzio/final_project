<h1>REPORT A POTHOLE</h1>
<button id="addPinButton"  onclick="deleteMarkers();">Post Pin</button>
<div style="width: 580px ;height:480px;" id="mapWrapper">
	<h3>Pin A Pothole</h3>
	<div id="googleMap" style="width:100%;height:98%;"></div>
		
</div>
<div>
</div>
<script src="https://maps.googleapis.com/maps/api/js"
  type="text/javascript"></script>
<script>

	var map;

	function initialize() {
		var mapProp = {
		  	center:new google.maps.LatLng(40.630037, -74.250944),
		    zoom:14,
		    minZoom: 12,
		    disableDefaultUI: true,
		    mapTypeId:google.maps.MapTypeId.ROADMAP
		  };

		  map = new google.maps.Map(document.getElementById("googleMap"),mapProp);

		  google.maps.event.addListener(map, 'click', function(event) {

		     placeMarker(event.latLng);
		    	clearMarkers();
        	markers = [];
				
		  });
	}

	function placeMarker(location) {

	// googleMap.clear()

	  var marker = new google.maps.Marker({
	    position: location,
	    map: map,
	    draggable: true,
    	animation: google.maps.Animation.DROP,
	  });

	  // attempted to add an event to limit the user to one marker
	  // at a time
	  // google.maps.event.addMarker(map, 'click', function(event) {
	  // 		map.clear();
	  // });

	  var pinned_lat = marker.position.lat();
	  var pinned_lng = marker.position.lng();

	  var contentString = '<%= form_for(@pothole) do |f| %>' +
		'<ul>'+
			'<li><%= f.label :street %>'+
			'<%= f.text_field :street %></li>'+
			'<li><%= f.label :date_reported %>'+
			'<%= f.date_field :date_reported %></li>'+
			'<li><%= f.label "Small" %>'+
			'<%= f.radio_button :size, "Small" %>'+
			'<%= f.label "Medium" %>'+
			'<%= f.radio_button :size, "Medium" %>'+
			'<%= f.label "Large" %>'+
			'<%= f.radio_button :size, "Large" %></li>'+
			'<li><%= f.label :description %>'+
			'<%= f.text_field :description %></li>'+
			'<input value="' + pinned_lat + '" type="hidden" name="pothole[latitude]" id="pothole_latitude" />' +
			'<input value="' + pinned_lng + '" type="hidden" name="pothole[longitude]" id="pothole_longitude" />' + 
			'<%= f.submit "Submit" %>'+
		'</ul>'+
		'<% end %>';

	

	  var infowindow = new google.maps.InfoWindow({
	    content: contentString
	  });
	  infowindow.open(map,marker);
	}

	function clearMarkers() {
	  clearMarkers();
        markers = [];
	}

	google.maps.event.addDomListener(window, 'load', initialize);

</script>
